import{s as M,a as J,m as j,b as U,c as G,d as Z,t as V,e as q,z as K,i as Q,l as tt}from"./link.kxq45SZt.js";function et(l){var e=0,t=l.children,a=t&&t.length;if(!a)e=1;else for(;--a>=0;)e+=t[a].value;l.value=e}function nt(){return this.eachAfter(et)}function it(l){var e=this,t,a=[e],o,i,s;do for(t=a.reverse(),a=[];e=t.pop();)if(l(e),o=e.children,o)for(i=0,s=o.length;i<s;++i)a.push(o[i]);while(a.length);return this}function ot(l){for(var e=this,t=[e],a,o;e=t.pop();)if(l(e),a=e.children,a)for(o=a.length-1;o>=0;--o)t.push(a[o]);return this}function at(l){for(var e=this,t=[e],a=[],o,i,s;e=t.pop();)if(a.push(e),o=e.children,o)for(i=0,s=o.length;i<s;++i)t.push(o[i]);for(;e=a.pop();)l(e);return this}function rt(l){return this.eachAfter(function(e){for(var t=+l(e.data)||0,a=e.children,o=a&&a.length;--o>=0;)t+=a[o].value;e.value=t})}function st(l){return this.eachBefore(function(e){e.children&&e.children.sort(l)})}function lt(l){for(var e=this,t=ct(e,l),a=[e];e!==t;)e=e.parent,a.push(e);for(var o=a.length;l!==t;)a.splice(o,0,l),l=l.parent;return a}function ct(l,e){if(l===e)return l;var t=l.ancestors(),a=e.ancestors(),o=null;for(l=t.pop(),e=a.pop();l===e;)o=l,l=t.pop(),e=a.pop();return o}function dt(){for(var l=this,e=[l];l=l.parent;)e.push(l);return e}function ht(){var l=[];return this.each(function(e){l.push(e)}),l}function ut(){var l=[];return this.eachBefore(function(e){e.children||l.push(e)}),l}function gt(){var l=this,e=[];return l.each(function(t){t!==l&&e.push({source:t.parent,target:t})}),e}function D(l,e){var t=new T(l),a=+l.value&&(t.value=l.value),o,i=[t],s,n,d,u;for(e==null&&(e=ft);o=i.pop();)if(a&&(o.value=+o.data.value),(n=e(o.data))&&(u=n.length))for(o.children=new Array(u),d=u-1;d>=0;--d)i.push(s=o.children[d]=new T(n[d])),s.parent=o,s.depth=o.depth+1;return t.eachBefore(xt)}function pt(){return D(this).eachBefore(mt)}function ft(l){return l.children}function mt(l){l.data=l.data.data}function xt(l){var e=0;do l.height=e;while((l=l.parent)&&l.height<++e)}function T(l){this.data=l,this.depth=this.height=0,this.parent=null}T.prototype=D.prototype={constructor:T,count:nt,each:it,eachAfter:at,eachBefore:ot,sum:rt,sort:st,path:lt,ancestors:dt,descendants:ht,leaves:ut,links:gt,copy:pt};const yt="d3-flextree",Ct="2.1.2",vt="build/d3-flextree.js",wt="index",Et={name:"Chris Maloney",url:"http://chrismaloney.org"},kt="Flexible tree layout algorithm that allows for variable node sizes.",bt=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],Bt="https://github.com/klortho/d3-flextree",St="WTFPL",$t={type:"git",url:"https://github.com/klortho/d3-flextree.git"},_t={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},Lt={"d3-hierarchy":"^1.1.5"},Nt={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},Xt={name:yt,version:Ct,main:vt,module:wt,"jsnext:main":"index",author:Et,description:kt,keywords:bt,homepage:Bt,license:St,repository:$t,scripts:_t,dependencies:Lt,devDependencies:Nt},{version:zt}=Xt,Mt=Object.freeze({children:l=>l.children,nodeSize:l=>l.data.size,spacing:0});function Y(l){const e=Object.assign({},Mt,l);function t(n){const d=e[n];return typeof d=="function"?d:()=>d}function a(n){const d=s(i(),n,u=>u.children);return d.update(),d.data}function o(){const n=t("nodeSize"),d=t("spacing");return class I extends D.prototype.constructor{constructor(c){super(c)}copy(){const c=s(this.constructor,this,h=>h.children);return c.each(h=>h.data=h.data.data),c}get size(){return n(this)}spacing(c){return d(this,c)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const c=this.ancestors();return c[c.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((c,h)=>I.maxExtents(c,h.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(c,h){return{top:Math.min(c.top,h.top),bottom:Math.max(c.bottom,h.bottom),left:Math.min(c.left,h.left),right:Math.max(c.right,h.right)}}}}function i(){const n=o(),d=t("nodeSize"),u=t("spacing");return class extends n{constructor(c){super(c),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return d(this.data)}spacing(c){return u(this.data,c.data)}get x(){return this.data.x}set x(c){this.data.x=c}get y(){return this.data.y}set y(c){this.data.y=c}update(){return F(this),P(this),this}}}function s(n,d,u){const c=(h,p)=>{const f=new n(h);Object.assign(f,{parent:p,depth:p===null?0:p.depth+1,height:0,length:1});const x=u(h)||[];return f.children=x.length===0?null:x.map(g=>c(g,f)),f.children&&Object.assign(f,f.children.reduce((g,C)=>({height:Math.max(g.height,C.height+1),length:g.length+C.length}),f)),f};return c(d,null)}return Object.assign(a,{nodeSize(n){return arguments.length?(e.nodeSize=n,a):e.nodeSize},spacing(n){return arguments.length?(e.spacing=n,a):e.spacing},children(n){return arguments.length?(e.children=n,a):e.children},hierarchy(n,d){const u=typeof d>"u"?e.children:d;return s(o(),n,u)},dump(n){const d=t("nodeSize"),u=c=>h=>{const p=c+"  ",f=c+"    ",{x,y:g}=h,C=d(h),E=h.children||[],b=E.length===0?" ":`,${p}children: [${f}${E.map(u(f)).join(f)}${p}],${c}`;return`{ size: [${C.join(", ")}],${p}x: ${x}, y: ${g}${b}},`};return u(`
`)(n)}}),a}Y.version=zt;const F=(l,e=0)=>(l.y=e,(l.children||[]).reduce((t,a)=>{const[o,i]=t;F(a,l.y+l.ySize);const s=(o===0?a.lExt:a.rExt).bottom;o!==0&&Rt(l,o,i);const n=At(s,o,i);return[o+1,n]},[0,null]),Tt(l),Ot(l),l),P=(l,e,t)=>{typeof e>"u"&&(e=-l.relX-l.prelim,t=0);const a=e+l.relX;return l.relX=a+l.prelim-t,l.prelim=0,l.x=t+l.relX,(l.children||[]).forEach(o=>P(o,a,l.x)),l},Tt=l=>{(l.children||[]).reduce((e,t)=>{const[a,o]=e,i=a+t.shift,s=o+i+t.change;return t.relX+=s,[i,s]},[0,0])},Rt=(l,e,t)=>{const a=l.children[e-1],o=l.children[e];let i=a,s=a.relX,n=o,d=o.relX,u=!0;for(;i&&n;){i.bottom>t.lowY&&(t=t.next);const c=s+i.prelim-(d+n.prelim)+i.xSize/2+n.xSize/2+i.spacing(n);(c>0||c<0&&u)&&(d+=c,Dt(o,c),Yt(l,e,t.index,c)),u=!1;const h=i.bottom,p=n.bottom;h<=p&&(i=It(i),i&&(s+=i.relX)),h>=p&&(n=Ht(n),n&&(d+=n.relX))}!i&&n?Ft(l,e,n,d):i&&!n&&Pt(l,e,i,s)},Dt=(l,e)=>{l.relX+=e,l.lExtRelX+=e,l.rExtRelX+=e},Yt=(l,e,t,a)=>{const o=l.children[e],i=e-t;if(i>1){const s=a/i;l.children[t+1].shift+=s,o.shift-=s,o.change-=a-s}},Ht=l=>l.hasChildren?l.firstChild:l.lThr,It=l=>l.hasChildren?l.lastChild:l.rThr,Ft=(l,e,t,a)=>{const o=l.firstChild,i=o.lExt,s=l.children[e];i.lThr=t;const n=a-t.relX-o.lExtRelX;i.relX+=n,i.prelim-=n,o.lExt=s.lExt,o.lExtRelX=s.lExtRelX},Pt=(l,e,t,a)=>{const o=l.children[e],i=o.rExt,s=l.children[e-1];i.rThr=t;const n=a-t.relX-o.rExtRelX;i.relX+=n,i.prelim-=n,o.rExt=s.rExt,o.rExtRelX=s.rExtRelX},Ot=l=>{if(l.hasChildren){const e=l.firstChild,t=l.lastChild,a=(e.prelim+e.relX-e.xSize/2+t.relX+t.prelim+t.xSize/2)/2;Object.assign(l,{prelim:a,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:t.rExt,rExtRelX:t.rExtRelX})}},At=(l,e,t)=>{for(;t!==null&&l>=t.lowY;)t=t.next;return{lowY:l,index:e,next:t}},v={selection:J,select:M,max:j,min:U,sum:G,cumsum:Z,tree:V,stratify:q,zoom:K,zoomIdentity:Q,linkHorizontal:tt,flextree:Y};class jt{constructor(){const e={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:t=>t.nodeId||t.id,parentNodeId:t=>t.parentNodeId||t.parentId,rootMargin:40,nodeWidth:t=>250,nodeHeight:t=>150,neighbourMargin:(t,a)=>80,siblingsMargin:t=>20,childrenMargin:t=>60,compactMarginPair:t=>100,compactMarginBetween:t=>20,nodeButtonWidth:t=>40,nodeButtonHeight:t=>40,nodeButtonX:t=>-20,nodeButtonY:t=>-20,linkYOffset:30,pagingStep:t=>5,minPagingVisibleNodes:t=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:t=>v.zoom(),onZoomStart:t=>{},onZoom:t=>{},onZoomEnd:t=>{},onNodeClick:t=>t,onExpandOrCollapse:t=>t,nodeContent:t=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${t.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:t,state:a})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,bottom:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>
                    `,right:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,top:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>
                    `}[a.layout](t.children)}  </div>`,pagingButton:(t,a,o,i)=>{const s=i.pagingStep(t.parent),n=t.parent.data._pagingStep,d=t.parent.data._directSubordinatesPaging-n;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(d,s)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(t,a,o){v.select(this).select(".node-rect").attr("stroke",i=>i.data._highlighted||i.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",t.data._highlighted||t.data._upToTheRootHighlighted?10:1)},nodeEnter:t=>t,nodeExit:t=>t,linkUpdate:function(t,a,o){v.select(this).attr("stroke",i=>i.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",i=>i.data._upToTheRootHighlighted?5:1),t.data._upToTheRootHighlighted&&v.select(this).raise()},hdiagonal:function(t,a,o){const i=t.x,s=t.y,n=a.x,d=a.y;let u=o&&o.x!=null?o.x:i,c=o&&o.y!=null?o.y:s,h=n-i<0?-1:1,p=d-s<0?-1:1,f=35,x=Math.abs(n-i)/2<f?Math.abs(n-i)/2:f;x=Math.abs(d-s)/2<x?Math.abs(d-s)/2:x;let g=Math.abs(n-i)/2-x;return`
                          M ${u} ${c}
                          L ${u} ${s}
                          L ${i} ${s}
                          L ${i+g*h} ${s}
                          C ${i+g*h+x*h} ${s} 
                            ${i+g*h+x*h} ${s} 
                            ${i+g*h+x*h} ${s+x*p}
                          L ${i+g*h+x*h} ${d-x*p} 
                          C ${i+g*h+x*h}  ${d} 
                            ${i+g*h+x*h}  ${d} 
                            ${n-g*h}  ${d}
                          L ${n} ${d}
               `},diagonal:function(t,a,o,i={sy:0}){const s=t.x;let n=t.y;const d=a.x,u=a.y;let c=o&&o.x!=null?o.x:s,h=o&&o.y!=null?o.y:n,p=d-s<0?-1:1,f=u-n<0?-1:1;n+=i.sy;let x=35,g=Math.abs(d-s)/2<x?Math.abs(d-s)/2:x;g=Math.abs(u-n)/2<g?Math.abs(u-n)/2:g;let C=Math.abs(u-n)/2-g,E=Math.abs(d-s)-g*2;return`
                          M ${c} ${h}
                          L ${s} ${h}
                          L ${s} ${n}
                          L ${s} ${n+C*f}
                          C  ${s} ${n+C*f+g*f} ${s} ${n+C*f+g*f} ${s+g*p} ${n+C*f+g*f}
                          L ${s+E*p+g*p} ${n+C*f+g*f}
                          C  ${d}  ${n+C*f+g*f} ${d}  ${n+C*f+g*f} ${d} ${u-C*f}
                          L ${d} ${u}
               `},defs:function(t,a){return`<defs>
                    ${a.map(o=>{const i=this.getTextWidth(o.label,{ctx:t.ctx,fontSize:2,defaultFont:t.defaultFont});return`
                       <marker id="${o.from+"_"+o.to}" refX="${o._source.x<o._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${o._source.x<o._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${o.label?i+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${o.label||""}</text>
                       </marker>

                       <marker id="arrow-${o.from+"_"+o.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${o._source.x<o._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(t,a,o){v.select(this).attr("stroke",i=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",i=>"5").attr("pointer-events","none").attr("marker-start",i=>`url(#${i.from+"_"+i.to})`).attr("marker-end",i=>`url(#arrow-${i.from+"_"+i.to})`)},linkGroupArc:v.linkHorizontal().x(t=>t.x).y(t=>t.y),layoutBindings:{left:{nodeLeftX:t=>0,nodeRightX:t=>t.width,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x+t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x+t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkCompactXStart:t=>t.x+t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,a)=>t.firstCompactNode.x,compactLinkMidY:(t,a)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(t)/4,linkParentX:t=>t.parent.x+t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>t.width,buttonY:t=>t.height/2,centerTransform:({root:t,rootMargin:a,centerY:o,scale:i,centerX:s})=>`translate(${a},${o}) scale(${i})`,compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},nodeFlexSize:({height:t,width:a,siblingsMargin:o,childrenMargin:i,state:s,node:n})=>s.compact&&n.flexCompactDim?[n.flexCompactDim[0],n.flexCompactDim[1]]:[t+o,a+i],zoomTransform:({centerY:t,scale:a})=>`translate(0,${t}) scale(${a})`,diagonal:this.hdiagonal.bind(this),swap:t=>{const a=t.x;t.x=t.y,t.y=a},nodeUpdateTransform:({x:t,y:a,width:o,height:i})=>`translate(${t},${a-i/2})`},top:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>0,nodeBottomY:t=>t.height,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y+t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y+t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y+t.height/2,compactLinkMidX:(t,a)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y+t.parent.height,buttonX:t=>t.width/2,buttonY:t=>t.height,centerTransform:({root:t,rootMargin:a,centerY:o,scale:i,centerX:s})=>`translate(${s},${a}) scale(${i})`,nodeFlexSize:({height:t,width:a,siblingsMargin:o,childrenMargin:i,state:s,node:n,compactViewIndex:d})=>s.compact&&n.flexCompactDim?[n.flexCompactDim[0],n.flexCompactDim[1]]:[a+o,t+i],zoomTransform:({centerX:t,scale:a})=>`translate(${t},0}) scale(${a})`,diagonal:this.diagonal.bind(this),swap:t=>{},nodeUpdateTransform:({x:t,y:a,width:o,height:i})=>`translate(${t-o/2},${a})`},bottom:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>-t.height,nodeBottomY:t=>0,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y-t.height-t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y-t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y-t.height/2,compactLinkMidX:(t,a)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,linkX:t=>t.x,linkY:t=>t.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y-t.parent.height,buttonX:t=>t.width/2,buttonY:t=>0,centerTransform:({root:t,rootMargin:a,centerY:o,scale:i,centerX:s,chartHeight:n})=>`translate(${s},${n-a}) scale(${i})`,nodeFlexSize:({height:t,width:a,siblingsMargin:o,childrenMargin:i,state:s,node:n})=>s.compact&&n.flexCompactDim?[n.flexCompactDim[0],n.flexCompactDim[1]]:[a+o,t+i],zoomTransform:({centerX:t,scale:a})=>`translate(${t},0}) scale(${a})`,diagonal:this.diagonal.bind(this),swap:t=>{t.y=-t.y},nodeUpdateTransform:({x:t,y:a,width:o,height:i})=>`translate(${t-o/2},${a-i})`},right:{nodeLeftX:t=>-t.width,nodeRightX:t=>0,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x-t.width-t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x-t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x-t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>0,buttonY:t=>t.height/2,linkCompactXStart:t=>t.x-t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,a)=>t.firstCompactNode.x,compactLinkMidY:(t,a)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(t)/4,centerTransform:({root:t,rootMargin:a,centerY:o,scale:i,centerX:s,chartWidth:n})=>`translate(${n-a},${o}) scale(${i})`,nodeFlexSize:({height:t,width:a,siblingsMargin:o,childrenMargin:i,state:s,node:n})=>s.compact&&n.flexCompactDim?[n.flexCompactDim[0],n.flexCompactDim[1]]:[t+o,a+i],compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},zoomTransform:({centerY:t,scale:a})=>`translate(0,${t}) scale(${a})`,diagonal:this.hdiagonal.bind(this),swap:t=>{const a=t.x;t.x=-t.y,t.y=a},nodeUpdateTransform:({x:t,y:a,width:o,height:i})=>`translate(${t-o},${a-i/2})`}}};this.getChartState=()=>e,Object.keys(e).forEach(t=>{this[t]=function(a){if(arguments.length)e[t]=a;else return e[t];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){v.selection.prototype.patternify=function(e){var t=this,a=e.selector,o=e.tag,i=e.data||[a],s=t.selectAll("."+a).data(i,(n,d)=>typeof n=="object"&&n.id?n.id:d);return s.exit().remove(),s=s.enter().append(o).merge(s),s.attr("class",a),s}}getNodeChildren({data:e,children:t,_children:a},o){return o.push(e),t&&t.forEach(i=>{this.getNodeChildren(i,o)}),a&&a.forEach(i=>{this.getNodeChildren(i,o)}),o}initialZoom(e){const t=this.getChartState();return t.lastTransform.k=e,this}render(){const e=this.getChartState();if(!e.data||e.data.length==0)return console.log("ORG CHART - Data is empty"),e.container&&(M(e.container).select(".nodes-wrapper").remove(),M(e.container).select(".links-wrapper").remove(),M(e.container).select(".connections-wrapper").remove()),this;const t=v.select(e.container),a=t.node().getBoundingClientRect();a.width>0&&(e.svgWidth=a.width);const o={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:e.svgWidth,chartHeight:e.svgHeight};if(e.calc=o,o.centerX=o.chartWidth/2,o.centerY=o.chartHeight/2,e.firstDraw){const n={zoom:null};n.zoom=e.createZoom().clickDistance(10).on("start",(d,u)=>e.onZoomStart(d)).on("end",(d,u)=>e.onZoomEnd(d)).on("zoom",(d,u)=>{e.onZoom(d),this.zoomed(d,u)}).scaleExtent(e.scaleExtent),e.zoomBehavior=n.zoom}e.flexTreeLayout=Y({nodeSize:n=>{const d=e.nodeWidth(n),u=e.nodeHeight(n),c=e.siblingsMargin(n),h=e.childrenMargin(n);return e.layoutBindings[e.layout].nodeFlexSize({state:e,node:n,width:d,height:u,siblingsMargin:c,childrenMargin:h})}}).spacing((n,d)=>n.parent==d.parent?0:e.neighbourMargin(n,d)),this.setLayouts({expandNodesFirst:!1});const i=t.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",e.svgWidth).attr("height",e.svgHeight).attr("font-family",e.defaultFont);e.firstDraw&&i.call(e.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),e.svg=i;const s=i.patternify({tag:"g",selector:"chart"});return e.centerG=s.patternify({tag:"g",selector:"center-group"}),e.linksWrapper=e.centerG.patternify({tag:"g",selector:"links-wrapper"}),e.nodesWrapper=e.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),e.connectionsWrapper=e.centerG.patternify({tag:"g",selector:"connections-wrapper"}),e.defsWrapper=i.patternify({tag:"g",selector:"defs-wrapper"}),e.firstDraw&&e.centerG.attr("transform",()=>e.layoutBindings[e.layout].centerTransform({centerX:o.centerX,centerY:o.centerY,scale:e.lastTransform.k,rootMargin:e.rootMargin,root:e.root,chartHeight:o.chartHeight,chartWidth:o.chartWidth})),e.chart=s,this.update(e.root),v.select(window).on(`resize.${e.id}`,()=>{const n=v.select(e.container).node().getBoundingClientRect();e.svg.attr("width",n.width)}),e.firstDraw&&(e.firstDraw=!1),this}addNode(e){const t=this.getChartState();if(e&&(t.parentNodeId(e)==null||t.parentNodeId(e)==t.nodeId(e))&&t.data.length==0)return t.data.push(e),this.render(),this;const o=t.generateRoot(t.data).descendants(),i=o.filter(({data:s})=>t.nodeId(s).toString()===t.nodeId(e).toString())[0];return o.filter(({data:s})=>t.nodeId(s).toString()===t.parentNodeId(e).toString())[0],i?(console.log(`ORG CHART - ADD - Node with id "${t.nodeId(e)}" already exists in tree`),this):(e._centered&&!e._expanded&&(e._expanded=!0),t.data.push(e),this.updateNodesState(),this)}removeNode(e){const t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(({data:n})=>t.nodeId(n)==e)[0];return i?(i.descendants().forEach(n=>n.data._filteredOut=!0),t.data=t.data.filter(n=>!n._filteredOut),t.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${e}" not found in the tree`),this)}groupBy(e,t,a){const o={};return e.forEach(i=>{const s=t(i);o[s]||(o[s]=[]),o[s].push(i)}),Object.keys(o).forEach(i=>{o[i]=a(o[i])}),Object.entries(o)}calculateCompactFlexDimensions(e){const t=this.getChartState();e.eachBefore(a=>{a.firstCompact=null,a.compactEven=null,a.flexCompactDim=null,a.firstCompactNode=null}),e.eachBefore(a=>{if(a.children&&a.children.length>1){const o=a.children.filter(c=>!c.children);if(o.length<2)return;o.forEach((c,h)=>{h||(c.firstCompact=!0),h%2?c.compactEven=!1:c.compactEven=!0,c.row=Math.floor(h/2)});const i=v.max(o.filter(c=>c.compactEven),t.layoutBindings[t.layout].compactDimension.sizeColumn),s=v.max(o.filter(c=>!c.compactEven),t.layoutBindings[t.layout].compactDimension.sizeColumn),n=Math.max(i,s)*2,d=this.groupBy(o,c=>c.row,c=>v.max(c,h=>t.layoutBindings[t.layout].compactDimension.sizeRow(h)+t.compactMarginBetween(h))),u=v.sum(d.map(c=>c[1]));o.forEach(c=>{c.firstCompactNode=o[0],c.firstCompact?c.flexCompactDim=[n+t.compactMarginPair(c),u-t.compactMarginBetween(c)]:c.flexCompactDim=[0,0]}),a.flexCompactDim=null}})}calculateCompactFlexPositions(e){const t=this.getChartState();e.eachBefore(a=>{if(a.children){const o=a.children.filter(c=>c.flexCompactDim),i=o[0];if(!i)return;o.forEach((c,h,p)=>{h==0&&(i.x-=i.flexCompactDim[0]/2),h&h%2-1?c.x=i.x+i.flexCompactDim[0]*.25-t.compactMarginPair(c)/4:h&&(c.x=i.x+i.flexCompactDim[0]*.75+t.compactMarginPair(c)/4)});const s=i.x+i.flexCompactDim[0]*.5;i.x=i.x+i.flexCompactDim[0]*.25-t.compactMarginPair(i)/4;const n=a.x-s;Math.abs(n)<10&&o.forEach(c=>c.x+=n);const d=this.groupBy(o,c=>c.row,c=>v.max(c,h=>t.layoutBindings[t.layout].compactDimension.sizeRow(h))),u=v.cumsum(d.map(c=>c[1]+t.compactMarginBetween(c)));o.forEach((c,h)=>{c.row?c.y=i.y+u[c.row-1]:c.y=i.y})}})}update({x0:e,y0:t,x:a=0,y:o=0,width:i,height:s}){const n=this.getChartState();n.calc,n.compact&&this.calculateCompactFlexDimensions(n.root);const d=n.flexTreeLayout(n.root);n.compact&&this.calculateCompactFlexPositions(n.root);const u=d.descendants(),c=d.descendants().slice(1);u.forEach(n.layoutBindings[n.layout].swap);const h=n.connections,p={};n.allNodes.forEach(r=>p[n.nodeId(r.data)]=r);const f={};u.forEach(r=>f[n.nodeId(r.data)]=r),h.forEach(r=>{const m=p[r.from],y=p[r.to];r._source=m,r._target=y});const x=h.filter(r=>f[r.from]&&f[r.to]),g=n.defs.bind(this)(n,x),C=n.defsWrapper.html();g!==C&&n.defsWrapper.html(g);const E=n.linksWrapper.selectAll("path.link").data(c,r=>n.nodeId(r.data)),B=E.enter().insert("path","g").attr("class","link").attr("d",r=>{const m=n.layoutBindings[n.layout].linkJoinX({x:e,y:t,width:i,height:s}),y=n.layoutBindings[n.layout].linkJoinY({x:e,y:t,width:i,height:s}),w={x:m,y};return n.layoutBindings[n.layout].diagonal(w,w,w)}).merge(E);B.attr("fill","none"),this.isEdge()?B.style("display",r=>r.data._pagingButton?"none":"auto"):B.attr("display",r=>r.data._pagingButton?"none":"auto"),B.each(n.linkUpdate),B.transition().duration(n.duration).attr("d",r=>{const m=n.compact&&r.flexCompactDim?{x:n.layoutBindings[n.layout].compactLinkMidX(r,n),y:n.layoutBindings[n.layout].compactLinkMidY(r,n)}:{x:n.layoutBindings[n.layout].linkX(r),y:n.layoutBindings[n.layout].linkY(r)},y={x:n.layoutBindings[n.layout].linkParentX(r),y:n.layoutBindings[n.layout].linkParentY(r)},w=n.compact&&r.flexCompactDim?{x:n.layoutBindings[n.layout].linkCompactXStart(r),y:n.layoutBindings[n.layout].linkCompactYStart(r)}:m;return n.layoutBindings[n.layout].diagonal(m,y,w,{sy:n.linkYOffset})}),E.exit().transition().duration(n.duration).attr("d",r=>{const m=n.layoutBindings[n.layout].linkJoinX({x:a,y:o,width:i,height:s}),y=n.layoutBindings[n.layout].linkJoinY({x:a,y:o,width:i,height:s}),w={x:m,y};return n.layoutBindings[n.layout].diagonal(w,w,null,{sy:n.linkYOffset})}).remove();const L=n.connectionsWrapper.selectAll("path.connection").data(x),X=L.enter().insert("path","g").attr("class","connection").attr("d",r=>{const m=n.layoutBindings[n.layout].linkJoinX({x:e,y:t,width:i,height:s}),y=n.layoutBindings[n.layout].linkJoinY({x:e,y:t,width:i,height:s}),w={x:m,y};return n.layoutBindings[n.layout].diagonal(w,w,null,{sy:n.linkYOffset})}).merge(L);X.attr("fill","none"),X.transition().duration(n.duration).attr("d",r=>{const m=n.layoutBindings[n.layout].linkX({x:r._source.x,y:r._source.y,width:r._source.width,height:r._source.height}),y=n.layoutBindings[n.layout].linkY({x:r._source.x,y:r._source.y,width:r._source.width,height:r._source.height}),w=n.layoutBindings[n.layout].linkJoinX({x:r._target.x,y:r._target.y,width:r._target.width,height:r._target.height}),k=n.layoutBindings[n.layout].linkJoinY({x:r._target.x,y:r._target.y,width:r._target.width,height:r._target.height});return n.linkGroupArc({source:{x:m,y},target:{x:w,y:k}})}),X.each(n.connectionsUpdate),L.exit().transition().duration(n.duration).attr("opacity",0).remove();const S=n.nodesWrapper.selectAll("g.node").data(u,({data:r})=>n.nodeId(r)),z=S.enter().append("g").attr("class","node").attr("transform",r=>{if(r==n.root)return`translate(${e},${t})`;const m=n.layoutBindings[n.layout].nodeJoinX({x:e,y:t,width:i,height:s}),y=n.layoutBindings[n.layout].nodeJoinY({x:e,y:t,width:i,height:s});return`translate(${m},${y})`}).attr("cursor","pointer").on("click.node",(r,m)=>{const{data:y}=m;if(![...r.srcElement.classList].includes("node-button-foreign-object")){if([...r.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(m);return}if(!y._pagingButton){n.onNodeClick(m);return}console.log("event fired, no handlers")}}).on("keydown.node",(r,m)=>{if(r.key==="Enter"||r.key===" "||r.key==="Spacebar"){if([...r.srcElement.classList].includes("node-button-foreign-object"))return;if([...r.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(m);return}(r.key==="Enter"||r.key===" "||r.key==="Spacebar")&&this.onButtonClick(r,m)}});z.each(n.nodeEnter),z.patternify({tag:"rect",selector:"node-rect",data:r=>[r]});const $=z.merge(S).style("font","12px sans-serif");$.patternify({tag:"foreignObject",selector:"node-foreign-object",data:r=>[r]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:r=>[r]}),this.restyleForeignObjectElements();const H=z.patternify({tag:"g",selector:"node-button-g",data:r=>[r]}).on("click",(r,m)=>this.onButtonClick(r,m)).on("keydown",(r,m)=>{(r.key==="Enter"||r.key===" "||r.key==="Spacebar")&&this.onButtonClick(r,m)});H.patternify({tag:"rect",selector:"node-button-rect",data:r=>[r]}).attr("opacity",0).attr("pointer-events","all").attr("width",r=>n.nodeButtonWidth(r)).attr("height",r=>n.nodeButtonHeight(r)).attr("x",r=>n.nodeButtonX(r)).attr("y",r=>n.nodeButtonY(r)),H.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:r=>[r]}).attr("width",r=>n.nodeButtonWidth(r)).attr("height",r=>n.nodeButtonHeight(r)).attr("x",r=>n.nodeButtonX(r)).attr("y",r=>n.nodeButtonY(r)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:r=>[r]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%"),$.transition().attr("opacity",0).duration(n.duration).attr("transform",({x:r,y:m,width:y,height:w})=>n.layoutBindings[n.layout].nodeUpdateTransform({x:r,y:m,width:y,height:w})).attr("opacity",1),$.select(".node-rect").attr("width",({width:r})=>r).attr("height",({height:r})=>r).attr("x",({width:r})=>0).attr("y",({height:r})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",n.nodeDefaultBackground),$.select(".node-button-g").attr("transform",({data:r,width:m,height:y})=>{const w=n.layoutBindings[n.layout].buttonX({width:m,height:y}),k=n.layoutBindings[n.layout].buttonY({width:m,height:y});return`translate(${w},${k})`}).attr("display",({data:r})=>r._directSubordinates>0?null:"none").attr("opacity",({data:r,children:m,_children:y})=>r._pagingButton?0:m||y?1:0),$.select(".node-button-foreign-object .node-button-div").html(r=>n.buttonContent({node:r,state:n})),$.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:r})=>r?40:26).text(({children:r})=>r?"-":"+").attr("y",this.isEdge()?10:0),$.each(n.nodeUpdate);const R=S.exit();R.each(n.nodeExit);const A=R.data().reduce((r,m)=>r.depth<m.depth?r:m,{depth:1/0});R.attr("opacity",1).transition().duration(n.duration).attr("transform",r=>{let{x:m,y,width:w,height:k}=A.parent||{};const N=n.layoutBindings[n.layout].nodeJoinX({x:m,y,width:w,height:k}),W=n.layoutBindings[n.layout].nodeJoinY({x:m,y,width:w,height:k});return`translate(${N},${W})`}).on("end",function(){v.select(this).remove()}).attr("opacity",0),u.forEach(r=>{r.x0=r.x,r.y0=r.y});const _=n.allNodes.filter(r=>r.data._centered)[0];if(_){let r=[_];_.data._centeredWithDescendants&&(n.compact?r=_.descendants().filter((m,y)=>y<7):r=_.descendants().filter((m,y,w)=>{const k=Math.round(w.length/2),N=2;return w.length%2?y>k-N&&y<k+N-1:y>k-N&&y<k+N})),_.data._centeredWithDescendants=null,_.data._centered=null,this.fit({animate:!0,scale:!1,nodes:r})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(e,t,a,o){return this.getChartState().hdiagonal(e,t,a,o)}diagonal(e,t,a,o){return this.getChartState().diagonal(e,t,a,o)}restyleForeignObjectElements(){const e=this.getChartState();e.svg.selectAll(".node-foreign-object").attr("width",({width:t})=>t).attr("height",({height:t})=>t).attr("x",({width:t})=>0).attr("y",({height:t})=>0),e.svg.selectAll(".node-foreign-object-div").style("width",({width:t})=>`${t}px`).style("height",({height:t})=>`${t}px`).html(function(t,a,o){return t.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${e.pagingButton(t,a,o,e)}</div></div>`:e.nodeContent.bind(this)(t,a,o,e)})}onButtonClick(e,t){const a=this.getChartState();t.data._pagingButton||(a.setActiveNodeCentered&&(t.data._centered=!0,t.data._centeredWithDescendants=!0),t.children?(t._children=t.children,t.children=null,this.setExpansionFlagToChildren(t,!1)):(t.children=t._children,t._children=null,t.children&&t.children.forEach(({data:o})=>o._expanded=!0)),this.update(t),e.stopPropagation(),a.onExpandOrCollapse(t))}setExpansionFlagToChildren({data:e,children:t,_children:a},o){e._expanded=o,t&&t.forEach(i=>{this.setExpansionFlagToChildren(i,o)}),a&&a.forEach(i=>{this.setExpansionFlagToChildren(i,o)})}expandSomeNodes(e){if(e.data._expanded){let t=e.parent;for(;t&&t._children;)t.children=t._children,t._children=null,t=t.parent}e._children&&e._children.forEach(t=>this.expandSomeNodes(t)),e.children&&e.children.forEach(t=>this.expandSomeNodes(t))}updateNodesState(){const e=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(e.root)}setLayouts({expandNodesFirst:e=!0}){const t=this.getChartState();t.generateRoot=v.stratify().id(i=>t.nodeId(i)).parentId(i=>t.parentNodeId(i)),t.root=t.generateRoot(t.data);const a=t.root.descendants();t.initialExpandLevel>1&&a.length>0&&(a.forEach(i=>{i.depth<=t.initialExpandLevel&&(i.data._expanded=!0)}),t.initialExpandLevel=1);const o={};t.root.descendants().filter(i=>i.children).filter(i=>!i.data._pagingStep).forEach(i=>{i.data._pagingStep=t.minPagingVisibleNodes(i)}),t.root.eachBefore((i,s)=>{i.data._directSubordinatesPaging=i.children?i.children.length:0,i.children&&i.children.forEach((n,d)=>{if(n.data._pagingButton=!1,d>i.data._pagingStep&&(o[n.id]=!0),d===i.data._pagingStep&&i.children.length-1>i.data._pagingStep&&(n.data._pagingButton=!0),o[n.parent.id]&&(o[n.id]=!0),n.data._expanded||n.data._centered||n.data._highlighted||n.data._upToTheRootHighlighted){let u=n;for(;u&&(o[u.id]||u.data._pagingButton);)o[u.id]=!1,u.data._pagingButton&&(u.data._pagingButton=!1,u.parent.children.forEach(c=>{c.data._expanded=!0,o[c.id]=!1})),u=u.parent}})}),t.root=v.stratify().id(i=>t.nodeId(i)).parentId(i=>t.parentNodeId(i))(t.data.filter(i=>o[i.id]!==!0)),t.root.each((i,s,n)=>{let d=i._hierarchyHeight||i.height,u=t.nodeWidth(i),c=t.nodeHeight(i);Object.assign(i,{width:u,height:c,_hierarchyHeight:d})}),t.root.x0=0,t.root.y0=0,t.allNodes=t.root.descendants(),t.allNodes.forEach(i=>{Object.assign(i.data,{_directSubordinates:i.children?i.children.length:0,_totalSubordinates:i.descendants().length-1})}),t.root.children&&(e&&t.root.children.forEach(this.expand),t.root.children.forEach(i=>this.collapse(i)),t.initialExpandLevel==0&&(t.root._children=t.root.children,t.root.children=null),[t.root].forEach(i=>this.expandSomeNodes(i)))}collapse(e){e.children&&(e._children=e.children,e._children.forEach(t=>this.collapse(t)),e.children=null)}expand(e){e._children&&(e.children=e._children,e.children.forEach(t=>this.expand(t)),e._children=null)}zoomed(e,t){const a=this.getChartState(),o=a.chart,i=e.transform;a.lastTransform=i,o.attr("transform",i),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:e,x1:t,y0:a,y1:o,params:i={animate:!0,scale:!0,onCompleted:()=>{}}}){const{centerG:s,svgWidth:n,svgHeight:d,svg:u,zoomBehavior:c,duration:h,lastTransform:p}=this.getChartState();let f=Math.min(8,.9/Math.max((t-e)/n,(o-a)/d)),x=v.zoomIdentity.translate(n/2,d/2);x=x.scale(i.scale?f:p.k),x=x.translate(-(e+t)/2,-(a+o)/2),u.transition().duration(i.animate?h:0).call(c.transform,x),s.transition().duration(i.animate?h:0).attr("transform","translate(0,0)").on("end",function(){i.onCompleted&&i.onCompleted()})}fit({animate:e=!0,nodes:t,scale:a=!0,onCompleted:o=()=>{}}={}){const i=this.getChartState(),{root:s}=i;let n=t||s.descendants();const d=v.min(n,p=>p.x+i.layoutBindings[i.layout].nodeLeftX(p)),u=v.max(n,p=>p.x+i.layoutBindings[i.layout].nodeRightX(p)),c=v.min(n,p=>p.y+i.layoutBindings[i.layout].nodeTopY(p)),h=v.max(n,p=>p.y+i.layoutBindings[i.layout].nodeBottomY(p));return this.zoomTreeBounds({params:{animate:e,scale:a,onCompleted:o},x0:d-50,x1:u+50,y0:c-50,y1:h+50}),this}loadPagingNodes(e){const t=this.getChartState();e.data._pagingButton=!1;const a=e.parent.data._pagingStep,o=t.pagingStep(e.parent),i=a+o;e.parent.data._pagingStep=i,this.updateNodesState()}setExpanded(e,t=!0){const a=this.getChartState(),o=a.allNodes.filter(({data:i})=>a.nodeId(i)==e)[0];if(!o)return console.log(`ORG CHART - ${t?"EXPAND":"COLLAPSE"} - Node with id (${e})  not found in the tree`),this;if(o.data._expanded=t,t==!1){const i=o.parent||{descendants:()=>[]};i.descendants().filter(n=>n!=i).forEach(n=>n.data._expanded=!1)}return this}setCentered(e){const t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(({data:n})=>t.nodeId(n).toString()==e.toString())[0];return i?(i.ancestors().forEach(n=>n.data._expanded=!0),i.data._centered=!0,i.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${e}) not found in the tree`),this)}setHighlighted(e){const t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(n=>t.nodeId(n.data).toString()===e.toString())[0];return i?(i.ancestors().forEach(n=>n.data._expanded=!0),i.data._highlighted=!0,i.data._expanded=!0,i.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${e})  not found in the tree`),this)}setUpToTheRootHighlighted(e){const t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(n=>t.nodeId(n.data).toString()===e.toString())[0];return i?(i.ancestors().forEach(n=>n.data._expanded=!0),i.data._upToTheRootHighlighted=!0,i.data._expanded=!0,i.ancestors().forEach(n=>n.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${e}) not found in the tree`),this)}clearHighlighting(){const e=this.getChartState();return e.allNodes.forEach(t=>{t.data._highlighted=!1,t.data._upToTheRootHighlighted=!1}),this.update(e.root),this}fullscreen(e){const t=this.getChartState(),a=v.select(e||t.container).node();v.select(document).on("fullscreenchange."+t.id,function(o){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==a?setTimeout(s=>{t.svg.attr("height",window.innerHeight-40)},500):t.svg.attr("height",t.svgHeight)}),a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}zoomIn(){const{svg:e,zoomBehavior:t}=this.getChartState();e.transition().call(t.scaleBy,1.3)}zoomOut(){const{svg:e,zoomBehavior:t}=this.getChartState();e.transition().call(t.scaleBy,.78)}toDataURL(e,t){var a=new XMLHttpRequest;a.onload=function(){var o=new FileReader;o.onloadend=function(){t(o.result)},o.readAsDataURL(a.response)},a.open("GET",e),a.responseType="blob",a.send()}exportImg({full:e=!1,scale:t=3,onLoad:a=s=>s,save:o=!0,backgroundColor:i="#FAFAFA"}={}){const s=this,n=this.getChartState(),{svg:d,root:u}=n;let c=0;const h=d.selectAll("img");let p=h.size();const f=()=>{JSON.parse(JSON.stringify(s.lastTransform()));const x=s.duration();e&&s.fit();const{svg:g}=s.getChartState();setTimeout(C=>{s.downloadImage({node:g.node(),scale:t,isSvg:!1,backgroundColor:i,onAlreadySerialized:E=>{s.update(u)},imageName:n.imageName,onLoad:a,save:o})},e?x+10:0)};p>0?h.each(function(){s.toDataURL(this.src,x=>{this.src=x,++c==p&&f()})}):f()}exportSvg(){const{svg:e,imageName:t}=this.getChartState();return this.downloadImage({imageName:t,node:e.node(),scale:3,isSvg:!0}),this}expandAll(){const{allNodes:e,root:t,data:a}=this.getChartState();return a.forEach(o=>o._expanded=!0),this.render(),this}collapseAll(){const{allNodes:e,root:t}=this.getChartState();return e.forEach(a=>a.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:e,scale:t=2,imageName:a="graph",isSvg:o=!1,save:i=!0,backgroundColor:s="#FAFAFA",onAlreadySerialized:n=u=>{},onLoad:d=u=>{}}){const u=e;function c(g,C){var E=document.createElement("a");typeof E.download=="string"?(document.body.appendChild(E),E.download=C,E.href=g,E.click(),document.body.removeChild(E)):location.replace(g)}function h(g){const C="http://www.w3.org/2000/xmlns/",E="http://www.w3.org/1999/xlink",b="http://www.w3.org/2000/svg";g=g.cloneNode(!0);const B=window.location.href+"#",L=document.createTreeWalker(g,NodeFilter.SHOW_ELEMENT,null,!1);for(;L.nextNode();)for(const S of L.currentNode.attributes)S.value.includes(B)&&(S.value=S.value.replace(B,"#"));return g.setAttributeNS(C,"xmlns",b),g.setAttributeNS(C,"xmlns:xlink",E),new XMLSerializer().serializeToString(g)}if(o){let g=h(u);g=`<?xml version="1.0" standalone="no"?>\r
`+g;var x="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(g);c(x,a+".svg"),n();return}const p=t,f=document.createElement("img");f.onload=function(){const g=document.createElement("canvas"),C=u.getBoundingClientRect();g.width=C.width*p,g.height=C.height*p;const E=g.getContext("2d");E.fillStyle=s,E.fillRect(0,0,C.width*p,C.height*p),E.drawImage(f,0,0,C.width*p,C.height*p);let b=g.toDataURL("image/png");d&&d(b),i&&c(b,a+".png")};var x="data:image/svg+xml; charset=utf8, "+encodeURIComponent(h(u));n(),f.src=x}getTextWidth(e,{fontSize:t=14,fontWeight:a=400,defaultFont:o="Helvetice",ctx:i}={}){return i.font=`${a||""} ${t}px ${o} `,i.measureText(e).width}clear(){const e=this.getChartState();v.select(window).on(`resize.${e.id}`,null),e.svg&&e.svg.selectAll("*").remove()}}export{jt as OrgChart};
